
# Document Digitizer 🚀

A modern full-stack application for document digitization with OCR capabilities, featuring:
- **React 19 + TypeScript** frontend with Vite
- **FastAPI** backend with Python
- **Bilingual support** (English/Arabic) with RTL layout
- **Interactive text detection** with bounding boxes
- **Real-time image processing** and text extraction

## 🌟 Features

- 📄 **Document Upload**: Drag & drop or click to upload PDF, PNG, JPG, JPEG
- 🔍 **Text Extraction**: AI-powered OCR with configurable classifier
- 🖼️ **Interactive Preview**: Canvas overlay with clickable text regions
- 🌍 **Bilingual Interface**: Full English/Arabic support with RTL
- 📱 **Responsive Design**: Mobile-friendly modern UI
- ⚡ **Real-time Processing**: Live feedback and progress indicators

## 🚀 Quick Start

### Prerequisites
- Python 3.8+
- Node.js 20+
- npm or yarn

### 1. Clone and Setup
```bash
git clone <repository-url>

# Create Python virtual environment
python -m venv .venv
source .venv/bin/activate  # Windows: .venv\Scripts\activate

# Install Python dependencies
pip install -r requirements.txt

# Install frontend dependencies
cd frontend-react
npm install
cd ..
```

### 2. Development Mode (Recommended)

**Option A: Python Run Script (Recommended)**
```bash
python run.py
```

**Option B: Platform-Specific Scripts**
```bash
# Windows
dev.bat

# Linux/macOS
./dev.sh
```

**Option C: Frontend npm Script**
```bash
cd frontend-react
npm run start:full
```

**Option D: Simple Backend Start**
```bash
python start.py
# Then in another terminal: cd frontend-react && npm run dev
```

**Option E: Manual (Two Terminals)**
```bash
# Terminal 1: Backend
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# Terminal 2: Frontend
cd frontend-react
npm run dev
```

All options will give you:
- 🔧 Backend: http://localhost:8000
- 📱 Frontend: http://localhost:5173
- 📚 API Docs: http://localhost:8000/docs

### 3. Production Mode

**Option A: Automatic Build & Start**
```bash
python start.py prod
```

**Option B: Frontend npm Script**
```bash
cd frontend-react
npm run build:production
```

**Option C: Manual**
```bash
# Build frontend
cd frontend-react
npm run build
cd ..

# Start production server
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

## 📁 Project Structure

```
├── app/                     # FastAPI Backend
│   ├── main.py             # Main application (serves React SPA)
│   ├── api.py              # API routes (/api/*)
│   ├── config.py           # Configuration settings
│   └── static/img/         # Images (backward compatibility)
├── frontend-react/         # React Frontend
│   ├── src/
│   │   ├── components/
│   │   │   └── DocumentDigitizer.tsx   # Main document processing component
│   │   ├── stores/
│   │   │   └── documentStore.ts        # Zustand store for state management
│   │   ├── hooks/
│   │   │   └── useI18n.ts              # Internationalization utilities
│   │   ├── views/
│   │   │   ├── HomeView.tsx            # Home page with DocumentDigitizer
│   │   │   └── AboutView.tsx           # About page
│   │   └── router/         # React Router configuration
│   ├── public/images/      # Static images for frontend
│   ├── package.json        # Frontend dependencies and scripts
│   └── vite.config.ts      # Vite build configuration
├── dist/                   # Built frontend (generated by npm run build)
├── run.py                  # Development server script (both backend + frontend)
├── start.py               # Simple backend starter script
├── build.py               # Build helper script
├── Dockerfile             # Multi-stage Docker build
├── .dockerignore          # Docker build optimization
└── docker-build.*         # Docker build scripts
```

## 🛠️ Available Scripts

### Development Scripts
```bash
python run.py              # Start both servers with monitoring (recommended)
python start.py            # Start backend only (simple)
python start.py prod       # Build and start production
python build.py dev        # Alternative dev server starter
python build.py build     # Build for production

# Platform-specific
dev.bat                    # Windows batch file (Unicode-safe)
./dev.sh                   # Linux/macOS shell script
```

### Frontend Scripts
```bash
cd frontend-react

npm run dev                 # Start Vite dev server
npm run build              # Build for production
npm run preview            # Preview production build
npm run lint               # Run ESLint
npm run format             # Format with Prettier
npm run type-check         # TypeScript type checking

# Combined scripts
npm run start:full         # Start both backend and frontend
npm run start:backend      # Start only backend
npm run build:production   # Build and start production server
```

### Backend Scripts
```bash
uvicorn app.main:app --reload              # Development
uvicorn app.main:app --host 0.0.0.0 --port 8000  # Production
```

## 🔧 Configuration

### Environment Variables
- `RQMNH_API_URL`: External API endpoint for text extraction
- `DEBUG`: Enable debug mode (default: True)
- `CORS_ORIGINS`: Allowed CORS origins

### Backend Configuration
Edit `app/config.py` for backend settings.

### Frontend Configuration
Edit `frontend-react/vite.config.ts` for build and development settings.

## 🌍 API Endpoints

- `POST /api/extract` - Document text extraction
- `GET /static/*` - Static files (legacy)
- `GET /` - React SPA (production mode)
- `GET /docs` - API documentation (Swagger UI)

## 🐳 Docker

The Dockerfile uses multi-stage build to create an optimized production image:

**Quick Build & Run:**
```bash
# Windows
docker-build.bat

# Linux/macOS
./docker-build.sh

# Or manually:
docker build -t document-digitizer:latest .
docker run -p 8000:8000 document-digitizer:latest
```

**What the Docker build does:**
1. **Stage 1**: Builds React frontend with Node.js 20
2. **Stage 2**: Creates Python backend with built frontend assets
3. **Security**: Runs as non-root user
4. **Health checks**: Built-in health monitoring
5. **Optimization**: Multi-stage build reduces final image size

**Environment Variables:**
```bash
# Optional environment variables
docker run -p 8000:8000 \
  -e RQMNH_API_URL=https://your-api.com \
  -e DEBUG=false \
  document-digitizer:latest
```

## 🔄 Migration from Legacy

This project has been upgraded from plain HTML/CSS/JS to React:

### ✅ Migrated Features
- Document upload interface → React component
- Canvas text detection → Reactive React component
- Language switching → React hook
- State management → Zustand store
- Styling → React components with Tailwind CSS

### 🔙 Backward Compatibility
- Legacy `/static/` routes still work
- API endpoints unchanged
- Falls back to HTML views if `dist/` doesn't exist

## 🚀 Technology Stack

### Frontend
- **React 19** - Modern JavaScript library for building user interfaces
- **TypeScript** - Type-safe JavaScript
- **Vite** - Fast build tool and dev server
- **Zustand** - Lightweight state management
- **React Router** - SPA routing
- **Lucide React** - Icon system

### Backend
- **FastAPI** - Modern Python web framework
- **Uvicorn** - ASGI server
- **Pydantic** - Data validation
- **CORS middleware** - Cross-origin requests

## 📱 Browser Support

- Modern browsers supporting ES2020+
- Mobile responsive design
- RTL language support for Arabic

## 🐛 Troubleshooting

### Common Issues

1. **Port already in use**:
   ```bash
   # Kill process on port 8000
   lsof -ti:8000 | xargs kill -9  # macOS/Linux
   netstat -ano | findstr :8000   # Windows
   ```

2. **Unicode/Special characters displaying incorrectly**:
   - `python run.py`
   - Or use `dev.bat` on Windows (sets proper encoding)
   - Characters like ➜, ⚡, 🔥 may show as � or boxes

3. **Frontend not building**:
   ```bash
   cd frontend-react
   rm -rf node_modules package-lock.json
   npm install
   ```

4. **API calls failing**:
   - Check backend is running on port 8000
   - Verify CORS settings in `app/main.py`
   - Check network proxy settings

5. **Dependencies issues**:
   ```bash
   # Python
   pip install --upgrade -r requirements.txt
   
   # Node.js
   cd frontend-react && npm install
   ```

## 📄 Documentation

- **API Documentation**: http://localhost:8000/docs (when running)
- **React Guide**: https://react.dev/
- **FastAPI Guide**: https://fastapi.tiangolo.com/

## 🤝 Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Run tests and linting
5. Submit a pull request

---

**Made with ❤️ using FastAPI + React**
